@if (hasProducts()) {
	<div class="cart-page">
		<h1 class="cart-title">Your Cart ({{ cartProducts().length }})</h1>

		<div class="cart-layout">
			<!-- Cart items -->
			<div class="cart-items">
				@for (
					product of cartProducts();
					track product.modelNo + '-' + product.size;
					let i = $index
				) {
					<div class="cart-item">
						<a class="item-image" [routerLink]="'/products/' + product.modelNo">
							<img
								[ngSrc]="product.productImage"
								alt="{{ product.productName }}"
								width="100"
								height="100"
							/>
						</a>

						<div class="item-body">
							<div class="item-top">
								<div class="item-info">
									<span class="item-brand">{{ product.vendor }}</span>
									<h3 class="item-name">{{ product.productName }}</h3>
									<span class="item-meta">Size: {{ product.size }}</span>
								</div>
								<div class="item-prices">
								<span class="item-price">{{ product.price * product.noOfItems | number: '1.2-2' }}€</span>
								<span class="item-price-original">{{ (product.price + product.price * 0.2) * product.noOfItems | number: '1.2-2' }}€</span>
								@if (product.noOfItems > 1) {
									<span class="unit-price">{{ product.price | number: '1.2-2' }}€ each</span>
								}
							</div>
							</div>

							<div class="item-bottom">
								<div class="qty-stepper">
									<button
										type="button"
										class="qty-btn"
										(click)="onRemoveItem(i)"
									>
										<mat-icon>{{ product.noOfItems <= 1 ? 'delete_outline' : 'remove' }}</mat-icon>
									</button>
									<span class="qty-value">{{ product.noOfItems }}</span>
									<button
										type="button"
										class="qty-btn"
										(click)="onAddItem(i)"
									>
										<mat-icon>add</mat-icon>
									</button>
								</div>
								<div class="stock-pills">
									<span [class]="'stock-pill ' + stockColor(stockInfo()[i]?.physical ?? 0)">
										<span class="dot"></span> Store
									</span>
									<span [class]="'stock-pill ' + stockColor(stockInfo()[i]?.online ?? 0)">
										<span class="dot"></span> Online
									</span>
								</div>
							</div>
						</div>
					</div>
				}
			</div>

			<!-- Desktop summary -->
			<aside class="summary">
				<h2 class="summary-title">Order Summary</h2>
				<div class="summary-line">
					<span>Original price</span>
					<span class="original-total">{{ originalTotal() | number: '1.2-2' }}€</span>
				</div>
				<div class="summary-line savings-line">
					<span>You save</span>
					<span class="savings-value">-{{ savings() | number: '1.2-2' }}€</span>
				</div>
				<div class="summary-line">
					<span>Shipping</span>
					<span class="free-tag">Free</span>
				</div>
				<div class="summary-divider"></div>
				<div class="summary-line total-line">
					<span>Total</span>
					<span>{{ grandTotal() | number: '1.2-2' }}€</span>
				</div>
				<button
					mat-flat-button
					class="primary-button summary-btn"
					(click)="onSubmit()"
				>
					Proceed to Checkout
				</button>
				<a class="continue-link" routerLink="/products">
					<mat-icon class="continue-icon">arrow_back</mat-icon>
					Continue Shopping
				</a>
			</aside>
		</div>

		<!-- Mobile checkout bar -->
		<div class="mobile-bar">
			<div class="mobile-bar-info">
				<span class="mobile-bar-label">Total <span class="mobile-savings">(-{{ savings() | number: '1.2-2' }}€)</span></span>
				<span class="mobile-bar-price">{{ grandTotal() | number: '1.2-2' }}€</span>
			</div>
			<button mat-flat-button class="primary-button mobile-bar-btn" (click)="onSubmit()">
				Checkout
			</button>
		</div>
	</div>
} @else {
	<div class="empty-cart">
		<mat-icon class="empty-icon">shopping_cart</mat-icon>
		<h2>Your cart is empty</h2>
		<p>Looks like you haven't added anything yet.</p>
		<a mat-flat-button class="primary-button" routerLink="/products">
			Browse Products
		</a>
	</div>
}
